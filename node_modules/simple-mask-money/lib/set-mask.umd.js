!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).SimpleMaskMoney=t()}(this,(function(){"use strict";const e={allowNegative:!1,negativeSignAfter:!1,decimalSeparator:",",fixed:!0,fractionDigits:2,prefix:"",suffix:"",thousandsSeparator:".",cursor:"end",allowEmpty:!1};function t(t){return Object.assign(Object.assign({},e),t)}const n="0123456789".split("");return function(e,r){const l=t(r),{beforeFormat:i,afterFormat:o,allowNegative:s,negativeSignAfter:u,fractionDigits:a,decimalSeparator:c,thousandsSeparator:f,fixed:d,prefix:h,suffix:g,cursor:p,allowEmpty:m}=l;if("undefined"==typeof document)return()=>{};const v="string"==typeof e?document.querySelector(e):null!=e?e:null;if(null===v)return()=>{};if(!(v instanceof HTMLInputElement))throw new Error("the element must be an input");const y=d?"0":"_";v.hasAttribute("inputmode")||v.setAttribute("inputmode","numeric");const b=(e,t)=>{v.value=e,v.dispatchEvent(new InputEvent("input")),L(t),N=e,null==o||o(e)},k=h.length,E=[...n,"Backspace",s?"-":""],w=3+c.length+a,S=e=>{var t;return null!==(t=null==e?void 0:e.length)&&void 0!==t?t:v.value.length-g.length},x=e=>e<k,A=e=>g.length>0&&e>S(),j=(e,t=!1,n)=>{let r;const l=[...e];let i=new Array;if(n){[r]=n;const[,e]=n,[t,i]=e,o=l.splice(...e);if("remove"===r&&1===o.length){const[e]=o;e!==c&&e!==f||l.splice(t-1,i)}}let o=w,s=!1,d=0,p=!1;for(let e;e=l.pop();)if("-"!==e)if(e===c&&s&&t){const e=i.indexOf(c);i.splice(e,c.length);const t=i.slice(0,a);t.length<i.length&&(o+=i.length-t.length),i=[c,...t],s=!0}else Number.isNaN(Number(e))||" "===e||(o-=1,e===y?d+=1:e!==c&&d>0&&(d=0),0===o&&(i.unshift(f),o=3),i.unshift(e),i.length!==a||s||(i.unshift(c),s=!0));else p=!0;return 0!==d&&i.splice(0,d),i.every((e=>e===y))&&"remove"===r&&(p=!1),i.length<=a?i=[y,c,i.join("").padStart(a,y)]:i.length===a+c.length&&i.unshift(y),p&&i[u?"push":"unshift"]("-"),(e=>`${h}${e}${g}`)(i.join(""))},L=e=>{const t=S();let n=[t,t];return"move"===p&&e&&(n="number"==typeof e[1]?[e[0],e[1]]:[e[0],e[0]]),v.setSelectionRange(...n),n};null==i||i(v.value);const M=j(v.value.split(""),!0);let N=M;const O=e=>{var t,n;null==i||i(v.value);const r=S();let l=null!==(t=v.selectionStart)&&void 0!==t?t:r,o=null!==(n=v.selectionEnd)&&void 0!==n?n:r;if("Enter"===e.key)return;if("Tab"===e.key)return;if(e.ctrlKey&&"a"===e.key)return L([k,r]);if(e.ctrlKey&&"z"===e.key)return b(M);if("move"===p&&("ArrowLeft"===e.key&&l>k||"ArrowRight"===e.key&&l<r))return;if(e.preventDefault(),e.ctrlKey&&"a"===e.key)return L([k,r]);if(!E.includes(e.key))return;const s="Backspace"===e.key;if(x(l)&&([l,o]=L([k])),A(l)&&([l,o]=L([r])),s&&0===l)return;if(m&&s&&v.value.length<=h.length+1)return void b(h);const u=v.value.split(""),a=Math.abs(o-l),c=a>0,f=c?[l,a]:[l-1,1],d=[l,c?a:0,e.key],g=s?"remove":"add",y=j(u,!1,[g,{add:d,remove:f}[g]]);if(!s&&N.length<y.length&&l<S(y))l+=y.length-N.length,o+=y.length-N.length;else if(s&&N.length>y.length&&l>k){const e=N.length-y.length;l=l-e<=k?k:l-e,o=o-e<=k?k:o-e}b(y,[l,o])},T=()=>{if(document.activeElement!==v)return;const e=v.selectionStart,t=v.selectionEnd;if("number"!=typeof e||"number"!=typeof t)return;let n;const r=x(e),l=A(t),i=A(e),o=x(t);(r||l||o||i)&&(n=[r?k:l?S():e,o?k:l?S():t]),n&&L(n)};if(b(m&&M===`${h}0`?"":M),v.hasAttribute("readonly")||v.hasAttribute("disabled"))return()=>{};v.addEventListener("keydown",O),document.addEventListener("selectionchange",T);const $=()=>{v.removeEventListener("keydown",O),document.removeEventListener("selectionchange",T),delete v.removeMask};return Object.defineProperty(v,"removeMask",{value:$,configurable:!0,enumerable:!0,writable:!0}),$}}));
//# sourceMappingURL=set-mask.umd.js.map
